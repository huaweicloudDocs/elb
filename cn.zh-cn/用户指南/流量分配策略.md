# 流量分配策略<a name="elb_ug_jt_0003"></a>

增强型负载均衡算法，支持以下三种调度算法：

-   加权轮询算法：根据后端服务器的权重，按顺序依次将请求分发给不同的服务器。它用相应的权重表示服务器的处理性能，按照权重的高低以及轮询方式将请求分配给各服务器，相同权重的服务器处理相同数目的连接数。常用于短连接服务，例如HTTP等服务。
-   加权最少连接：最少连接是通过当前活跃的连接数来估计服务器负载情况的一种动态调度算法。加权最少连接就是在最少连接数的基础上，根据服务器的不同处理能力，给每个服务器分配不同的权重，使其能够接受相应权值数的服务请求。常用于长连接服务，例如数据库连接等服务。
-   源IP算法：将请求的源IP地址进行Hash运算，得到一个具体的数值，同时对后端服务器进行编号，按照运算结果将请求分发到对应编号的服务器上。这可以使得对不同源IP的访问进行负载分发，同时使得同一个客户端IP的请求始终被派发至某特定的服务器。该方式适合负载均衡无cookie功能的TCP协议。

经典型负载均衡算法，支持以下三种调度算法：

-   轮询算法：按顺序把每个新的连接请求分配给下一个服务器，最终把所有请求平分给所有的服务器。常用于短连接服务，例如HTTP等服务。
-   最少连接：通过当前活跃的连接数来估计服务器负载情况的一种动态调度算法，系统把新的连接请求分配给当前连接数目最少的服务器。常用于长连接服务，例如数据库连接等服务。
-   源IP算法：将请求的源IP地址进行Hash运算，得到一个具体的数值，同时对后端服务器进行编号，按照运算结果将请求分发到对应编号的服务器上。这可以使得对不同源IP的访问进行负载分发，同时使得同一个客户端IP的请求始终被派发至某特定的服务器。该方式适合负载均衡无cookie功能的TCP协议。

## 权重设置<a name="section8226427131317"></a>

每台后端服务器的权重取值范围为\[0, 100\]。新的请求不会转发到权重为0的后端服务器上，此时健康检查状态没有参考意义。以下三种算法支持权重设置。

-   在加权轮询算法中，每台后端服务器的权重取值范围为\[0, 100\]。新的请求不会转发到权重为0的后端。在非0的权重下，负载均衡器会将请求按权重值的大小分配给所有的后端服务器。当后端服务器的权重都设置为相等时，权重属性将不再生效，负载均衡器将按照简单的轮询策略分发请求。
-   在加权最少连接算法中，每台后端服务器的权重取值范围为\[0, 100\]。新的请求不会转发到权重为0的后端。在非0的权重下，负载均衡器会通过 overhead=当前连接数/权重 来计算每个服务器负载。每次调度会选择overhead最小的后端服务器。
-   在源IP算法中，每台后端服务器的权重取值范围为\[0, 100\]，但是只做0和非0的区分。新的请求不会转发到权重为0的后端。在非0的权重下，由于使用了源IP算法，各个后端服务器的权重属性将不再生效，在一段时间内，同一个客户端的IP地址的请求会被调度至同一个后端服务器上。

权重设置步骤如下：

1.  登录管理控制台。
2.  在管理控制台左上角单击![](figures/zh-cn_image_0167649573.jpg)图标，选择区域和项目。
3.  选择“服务列表 \> 网络 \> 弹性负载均衡”。
4.  在“负载均衡器”界面，单击需要修改后端服务器权重的负载均衡名称。
5.  在该负载均衡界面，切换到“后端服务器组”页签，在目标服务器所在行的操作列中，编辑“权重”列，设置需要权重值。
6.  单击“确定”。

